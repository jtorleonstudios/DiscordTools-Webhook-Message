<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DiscordTools - Webhook message</title>
  <style>
    /*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */
    html {
      line-height: 1.15;
      -webkit-text-size-adjust: 100%
    }

    body {
      margin: 0
    }

    main {
      display: block
    }

    h1 {
      font-size: 2em;
      margin: .67em 0
    }

    hr {
      box-sizing: content-box;
      height: 0;
      overflow: visible
    }

    pre {
      font-family: monospace, monospace;
      font-size: 1em
    }

    a {
      background-color: transparent
    }

    abbr[title] {
      border-bottom: none;
      text-decoration: underline;
      text-decoration: underline dotted
    }

    b,
    strong {
      font-weight: bolder
    }

    code,
    kbd,
    samp {
      font-family: monospace, monospace;
      font-size: 1em
    }

    small {
      font-size: 80%
    }

    sub,
    sup {
      font-size: 75%;
      line-height: 0;
      position: relative;
      vertical-align: baseline
    }

    sub {
      bottom: -.25em
    }

    sup {
      top: -.5em
    }

    img {
      border-style: none
    }

    button,
    input,
    optgroup,
    select,
    textarea {
      font-family: inherit;
      font-size: 100%;
      line-height: 1.15;
      margin: 0
    }

    button,
    input {
      overflow: visible
    }

    button,
    select {
      text-transform: none
    }

    [type=button],
    [type=reset],
    [type=submit],
    button {
      -webkit-appearance: button
    }

    [type=button]::-moz-focus-inner,
    [type=reset]::-moz-focus-inner,
    [type=submit]::-moz-focus-inner,
    button::-moz-focus-inner {
      border-style: none;
      padding: 0
    }

    [type=button]:-moz-focusring,
    [type=reset]:-moz-focusring,
    [type=submit]:-moz-focusring,
    button:-moz-focusring {
      outline: 1px dotted ButtonText
    }

    fieldset {
      padding: .35em .75em .625em
    }

    legend {
      box-sizing: border-box;
      color: inherit;
      display: table;
      max-width: 100%;
      padding: 0;
      white-space: normal
    }

    progress {
      vertical-align: baseline
    }

    textarea {
      overflow: auto
    }

    [type=checkbox],
    [type=radio] {
      box-sizing: border-box;
      padding: 0
    }

    [type=number]::-webkit-inner-spin-button,
    [type=number]::-webkit-outer-spin-button {
      height: auto
    }

    [type=search] {
      -webkit-appearance: textfield;
      outline-offset: -2px
    }

    [type=search]::-webkit-search-decoration {
      -webkit-appearance: none
    }

    ::-webkit-file-upload-button {
      -webkit-appearance: button;
      font: inherit
    }

    details {
      display: block
    }

    summary {
      display: list-item
    }

    template {
      display: none
    }

    [hidden] {
      display: none
    }
  </style>
  <style>
    :root {
      --jtl: #ef5264;
      --bg: #ececec;
      --bg-1: #c8c8c8;
      --bg-2: #e2e2e2;
      --fg: #1e1e1e;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #1e1e1e;
        --bg-1: #0f0f0f;
        --bg-2: #242424;
        --fg: #ececec;
      }
    }

    @media (prefers-color-scheme: light) {
      :root {
        --bg: #ececec;
        --bg-1: #c8c8c8;
        --bg-2: #e2e2e2;
        --fg: #1e1e1e;
      }
    }

    * {
      box-sizing: border-box;
    }

    ::-webkit-scrollbar {
      width: 7px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--fg);
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--bg);
    }

    .row::after {
      content: "";
      clear: both;
      display: block;
    }

    [class*="col-"] {
      float: left;
    }

    .col-1 {
      width: 8.33%;
    }

    .col-2 {
      width: 16.66%;
    }

    .col-3 {
      width: 25%;
    }

    .col-4 {
      width: 33.33%;
    }

    .col-5 {
      width: 41.66%;
    }

    .col-6 {
      width: 50%;
    }

    .col-7 {
      width: 58.33%;
    }

    .col-8 {
      width: 66.66%;
    }

    .col-9 {
      width: 75%;
    }

    .col-10 {
      width: 83.33%;
    }

    .col-11 {
      width: 91.66%;
    }

    .col-12 {
      width: 100%;
    }

    @media only screen and (max-width: 768px) {

      /* For mobile phones: */
      [class*="col-"] {
        width: 100%;
      }
    }

    body {
      background: var(--bg);
      color: var(--fg);
      font-family: Garamond, serif;
    }

    a {
      color: var(--jtl);
      opacity: .9;
      text-decoration: none;
    }

    a:hover {
      opacity: 1;
    }

    header {
      background: var(--bg-1);
      background-image: url("https://media.forgecdn.net/attachments/466/923/bh_jtl_logo_semitransparent.png");
      background-repeat: no-repeat;
      background-position: right;
      background-size: auto calc(100% - 18px);
      background-position-x: calc(100% - 9px);
      padding: 15px;
    }

    input,
    textarea,
    button {
      outline: none;
      border: none;
      border-radius: 10px;
      padding: 15px 10px;
      background: var(--bg-2);
      color: var(--fg);
      font-family: Garamond, serif;
    }

    input:hover,
    textarea:hover,
    button:hover {
      box-shadow: 1px 0px 10px var(--jtl);
    }

    button {
      cursor: pointer;
      font-size: 25px;
    }

    button:disabled {
      cursor: not-allowed;
      opacity: 0.7;
    }

    main {
      padding: 15px;
      padding-bottom: 50px;
    }

    footer {
      padding: 15px;
      position: fixed;
      left: 0;
      bottom: 0;
      background: var(--bg-1);
    }

    label {
      padding: 15px 5px;
      font-size: 18px;
    }


    .error {
      animation-name: error;
      animation-duration: 2s;
    }

    .success {
      animation-name: success;
      animation-duration: 2s;
    }

    @keyframes success {
      from {
        background-color: rgb(40, 233, 40);
      }

      to {
        background: var(--bg-2);
      }
    }

    @keyframes error {
      from {
        background-color: red;
      }

      to {
        background: var(--bg-2);
      }
    }
  </style>
</head>

<body class="row">
  <header class="col-12">
    <h1>
      DiscordTools powered by <span style="color:var(--jtl)">JTorLeon
        Studios</span> !
    </h1>
    <p style="font-size:21px;">
      &#127919;
      Send a personalized message on a discord channel of your choice using a
      webhook.
    </p>
  </header>

  <main class="col-12">

    <h2>Setup message</h2>

    <!-- OUTPUT NOTIF -->
    <div id="output_notification" class="col-12">
    </div>

    <!-- INPUT: WEBHOOK CHANNEL -->
    <div class="col-12">
      <label for="webhook_channel" class="col-12">
        Please enter the url of the webhook corresponding to the channel that
        will receive the message
      </label>
      <input id="webhook_channel" type="text"
        placeholder=" enter the channel webhook" class="col-12" />
    </div>

    <div class="col-12" style="margin-top:15px;">

      <!-- INPUT: AVATAR SRC AUTHOR -->
      <div class="col-6" style="padding-right:5px;">
        <label for="icon_bot" class="col-12">
          Please indicate an URL for the avatar (.png, .jpg,...) of the author
          of the
          messages
        </label>
        <input id="icon_bot" type="text"
          placeholder=" Enter the icon url of the bot" class="col-12" />
      </div>

      <!-- INPUT: NAME AUTHOR -->
      <div class="col-6" style="padding-left:5px;">
        <label for="name_bot" class="col-12">
          Please indicate the author's name for the message. Example: Robot3300,
          Pierre
        </label>
        <input id="name_bot" type="text"
          placeholder=" Enter the name of the bot" class="col-12" />
      </div>

    </div>

    <!-- INPUT: MESSAGE -->
    <div class="col-12" style="margin-top:15px;">
      <label for="message_content" class="col-12">
        Please enter the content of the message (markdown ok)
      </label>
      <textarea id="message_content" name="" cols="30" rows="10"
        placeholder=" Enter your messages" class="col-12"></textarea>
    </div>


    <!-- SUBMIT: CALL FUNCTION -->
    <button id="submit_form_message" class="col-12" style="margin-top:15px;">
      Send !
    </button>

    <div class="col-12">
      <h2>Note</h2>
      <p>Webhooks are a low-effort way to post messages to channels in Discord.
        They do not require a bot user or authentication to use.</p>
    </div>
  </main>

  <footer class="col-12">
    &#128279;
    <a href="https://discord.gg/v9bgTszS5p" target="_blank"
      rel="noopener noreferrer" title="Join the server Discord">
      Discord
    </a>
    &#128279;
    <a href="https://www.reddit.com/r/JTorLeonStudios/" target="_blank"
      rel="noopener noreferrer" title="Join the community Reddit">
      Reddit
    </a>
    &#128279;
    <a href="https://twitter.com/JTorLeonCurse" target="_blank"
      rel="noopener noreferrer" title="Join the community Twitter">
      Twitter
    </a>
  </footer>

  <script>
    const OUTPUT_NOTIF = document.getElementById("output_notification");
    const BUTTON_SUBMIT = document.getElementById("submit_form_message");
    const INPUT_WEBHOOK = document.getElementById("webhook_channel");
    const INPUT_AVATAR = document.getElementById("icon_bot");
    const INPUT_NAME = document.getElementById("name_bot");
    const INPUT_RAW_MESSAGE = document.getElementById("message_content");
    if (!BUTTON_SUBMIT || !OUTPUT_NOTIF || !INPUT_WEBHOOK || !INPUT_AVATAR || !INPUT_NAME || !INPUT_RAW_MESSAGE) {
      throw new Error("Error not found a HTML element! Script brocken")
    }

    [INPUT_WEBHOOK, INPUT_AVATAR, INPUT_NAME, INPUT_RAW_MESSAGE].forEach(v => {
      v.onkeyup = () => { v.style.boxShadow = "" };
    })

    const BUTTON_SUBMIT_DEFAULT_TEXT = BUTTON_SUBMIT.outerText;

    BUTTON_SUBMIT.onclick = () => {
      let resultVerifyForm = verifyFormIsOk();
      if (resultVerifyForm === undefined) {
        BUTTON_SUBMIT.classList.add("error");
        BUTTON_SUBMIT.setAttribute("disabled", "");
        BUTTON_SUBMIT.innerText = `Error ! Aie ${String.fromCodePoint(128565)}, invalid form.`;
      } else {
        sendMessage(resultVerifyForm);
        BUTTON_SUBMIT.classList.add("success");
        BUTTON_SUBMIT.setAttribute("disabled", "");
        BUTTON_SUBMIT.innerText = `Success ! Message sent out ${String.fromCodePoint(128238)}.`;
      }

      setTimeout(() => {
        BUTTON_SUBMIT.classList.remove("success", "error");
        BUTTON_SUBMIT.removeAttribute("disabled");
        BUTTON_SUBMIT.innerText = BUTTON_SUBMIT_DEFAULT_TEXT;
      }, 2000 /* /!\ sync with css animation /!\ */)
    };

    function verifyFormIsOk() {
      let error = false;

      let emptyInput = false;
      let checkIfHasEmptyInput = (inputElement) => {
        if (inputElement.value === "") {
          inputElement.style.boxShadow = "1px 0px 10px red";
          emptyInput = true;
          error = true;
        }
      }

      checkIfHasEmptyInput(INPUT_WEBHOOK);
      checkIfHasEmptyInput(INPUT_AVATAR);
      checkIfHasEmptyInput(INPUT_NAME);
      checkIfHasEmptyInput(INPUT_RAW_MESSAGE);

      checkLink = async url => (await fetch(url)).ok
      if (!checkLink(INPUT_AVATAR.value)) {
        OUTPUT_NOTIF.innerHTML += `<div class="col-12 notifError">The url of the avatar to return a 404 response</div>`;
      }

      if (emptyInput)
        OUTPUT_NOTIF.innerHTML += `<div class="col-12 notifError">Please fill in the fields of the form that are empty</div>`;

      return (error) ? undefined : {
        webhook: INPUT_WEBHOOK.value,  
        avatar_url: INPUT_AVATAR.value, 
        username: INPUT_NAME.value,
        rawMessage: INPUT_RAW_MESSAGE.value,
      };
    }

    function sendMessage(formData) {
      let message = "**New** version available for the mod";
      let jsonBrut = {
        "username": formData.username,
        "avatar_url": formData.avatar_url,
        "content": formData.rawMessage,
        "embeds": [

          {
            "description": "" + message + "",
            "fields": [
              { "name": ":link: Download Forge:", "value": "undefined" }
            ],
            "color": 15258703
          }

        ]
      };

      let xhr = new XMLHttpRequest();
      xhr.open("POST", formData.webhook, true);
      xhr.setRequestHeader('Content-Type', 'application/json');
      xhr.send(JSON.stringify(jsonBrut));
    }

    console.debug("loaded script");
  </script>
</body>

</html>
